<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selectTime</title>

    <link rel="stylesheet" href="css/selectTime.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    
    <script type="text/javascript"> 
    /*
        여기에는 배열들이 들어가있다
        selectedArray는 2차원 배열로 왼쪽에 내가 선택하는 표를 만든다
        0은 선택안된거 1은 선택된거

        resultArray는 2차원 배열로 오른쪽에 다른사람들이 선택한걸 종합해서 결과를 보여준다
        0은 아무도 시간안되는거 1~인원수 는 그만큼 인원이 선택한거

        headcount는 총 인원수이다
    */
        var timeNum=10; //시간 개수 백에서 받아와야함.....
        var dayNum=6; //날짜 개수
        var selectedArray=new Array(timeNum);
        for(var i=0;i<timeNum;i++) {
            selectedArray[i]=new Array(dayNum);
            for(var j=0;j<dayNum;j++) {
                selectedArray[i][j]=0; //일단 다 0으로 초기화
            }
        }
        selectedArray[2][2]=1; //테스트용으로 넣어둔거

        var headcount=4; //인원수 백에서 받아와야..
        var resultArray=new Array(timeNum);
        for(var a=0;a<timeNum;a++) {
            resultArray[a]=new Array(dayNum);
            for(var b=0;b<dayNum;b++) {
                resultArray[a][b]=0; //일단 다 0으로 초기화
            }
        }
        resultArray[3][2]=1; //테스트용으로 넣어둔거
        resultArray[3][3]=3; //테스트용으로 넣어둔거
    

    </script>
</head>
<body>
    <div class="inner">
        <div class="titleBox">
            <h1>이게 제목입니다</h1>
        </div>
        <div class="timeBox">
            <div class="leftTimeBox">
                <div class="leftTimeHeader">
                    <p>안채완's Availability</p>
                    <div class="leftColorInfo">
                        <p style="background-color: pink; margin-right:20px;">불가능한 시간</p>
                        <p style="background-color: #A0CD63; margin-left:20px;">가능한 시간</p>
                    </div>
                </div>
                <div id="setLeftTable"></div>
                <script type="text/javascript">
                /*
                여기에는 왼쪽 표를 js로 그린다
                신경안써도 되는파트..
                */
                //테이블 생성시작
                    var tableAddr=new Array(timeNum+1); 
                    var table=document.createElement("table");
                    table.setAttribute("id","leftTable");
                    table.setAttribute("border",1);
                    for(var i=0;i<timeNum+1;i++) { 
                        var trString="tr";
                        tableAddr[i]=new Array(dayNum+1);
                        tableAddr[i]=document.createElement("tr");
                        tableAddr[i].setAttribute("id",trString+=i.toString());
                        for(var j=0;j<dayNum+1;j++) {
                            if(i==0) { //날짜넣는 맨위파트
                                tableAddr[0][j]=document.createElement("th");
                                tableAddr[0][j].style.backgroundColor="red"; //날짜넣을거임
                            } else {
                                if(j==0) { //시간넣는 맨왼쪽파트
                                    tableAddr[i][0]=document.createElement("th");
                                    tableAddr[i][0].style.backgroundColor="green"; //시간넣어야되나싶고그래...
                                } else {
                                    tableAddr[i][j]=document.createElement("td");
                                    if(i!=0 && selectedArray[i-1][j-1]==0) { //선택안된거
                                        tableAddr[i][j].style.backgroundColor="pink"; //선택안한거 색상
                                    } else {
                                        tableAddr[i][j].style.backgroundColor="#A0CD63"; //선택한거 색상
                                    }
                                   
                                    tableAddr[i][j].setAttribute("id",(i-1)+" "+(j-1)); //각 칸마다 id=0 1이런식
                                }
                            }
                            tableAddr[i][j].setAttribute("width",40);
                            tableAddr[i][j].setAttribute("height",30);
                            tableAddr[i].appendChild(tableAddr[i][j]);
                        }
                        table.appendChild(tableAddr[i]);
                    }
                    document.getElementById("setLeftTable").appendChild(table);
                //테이블 생성 완료


                //클릭, 드래그로 선택 시작
                    var rect=table.getBoundingClientRect();
                    intLeft=rect.left+40;
                    intTop=rect.top+30;

                    $(function () {
                        var isMouseDown = false;
                        $("td").mousedown(function () {
                            isMouseDown = true;
                            //document.getElementById($(this).attr("id")).style.backgroundColor="#A0CD63";
                            
                        })/*
                        .mouseover(function () {
                            if (isMouseDown) { //드래그는 시간되면 만들자......ㅠ
                                $(this).toggleClass("highlighted");
                            }
                        })*/
                        .click(function() { //일단 클릭만 만들었따..
                            var idString=$(this).attr("id");
                            var tempID=idString.split(" ");
                            
                            if(selectedArray[tempID[0]][tempID[1]]==1) {
                                selectedArray[tempID[0]][tempID[1]]=0;
                                document.getElementById($(this).attr("id")).style.backgroundColor="pink";
                            } else {
                                selectedArray[tempID[0]][tempID[1]]=1;
                                document.getElementById($(this).attr("id")).style.backgroundColor="#A0CD63";
                            }
                            
                        })
                       /* $(document).mouseup(function () {
                            isMouseDown = false;
                        });*/
                    });

                    
                //클릭, 드래그로 선택 완료
                </script>
            </div>



            <div class="rightTimeBox">
                <div class="rightTimeHeader">
                    
                    <div class="colorInfoBox">
                        <p style="margin-right:10px;">불가능</p>
                        <div id="colorChart" style=" border:solid; border-width: 2px; padding:0px"></div>
                        <script type="text/javascript">
                            var colorArray=document.createElement("table");
                            var colorRow=document.createElement("tr");
                            var colorMini=new Array(headcount+1);
                            for(var i=0;i<headcount+1;i++) {
                                colorMini[i]=document.createElement("td");
                                colorMini[i].style.backgroundColor='rgba('+51+','+153+','+0+','+i/headcount+')';
                                colorMini[i].setAttribute("width",25);
                                colorMini[i].setAttribute("height",25);
                                colorRow.appendChild(colorMini[i]);
                            }
                            colorArray.appendChild(colorRow);
                            document.getElementById("colorChart").appendChild(colorArray);
                        </script>
                        <p style="margin-left:10px;">가능</p>
                    </div>
                    
                </div>
                <div id="setRightTable"></div>
                <script type="text/javascript">
                /*
                    여기에는 오른쪽에 보여줄 표를 js로 그린다
                    신경안써도 되지않을까..
                */
                //테이블 생성시작
                    var RtableAddr=new Array(timeNum+1); 
                    var Rtable=document.createElement("table");
                    Rtable.setAttribute("id","rightTable");
                    Rtable.setAttribute("border",1);
                    for(var i=0;i<timeNum+1;i++) { 
                        var RtrString="tr";
                        RtableAddr[i]=new Array(dayNum+1);
                        RtableAddr[i]=document.createElement("tr");
                        for(var j=0;j<dayNum+1;j++) {
                            if(i==0) { //날짜넣는 맨위파트
                                RtableAddr[0][j]=document.createElement("th");
                                RtableAddr[0][j].style.backgroundColor="red"; //날짜넣을거임
                            } else {
                                if(j==0) { //시간넣는 맨왼쪽파트
                                    RtableAddr[i][0]=document.createElement("th");
                                    RtableAddr[i][0].style.backgroundColor="green"; //시간넣어야되나싶고그래...
                                } else {
                                    RtableAddr[i][j]=document.createElement("td");
                                    if(resultArray[i-1][j-1]==0) {
                                        RtableAddr[i][j].style.backgroundColor="white";
                                    } else {
                                        var f=resultArray[i-1][j-1]/headcount;
                                        RtableAddr[i][j].style.backgroundColor='rgba('+51+','+153+','+0+','+f+')';
                                    }
                                    
                                    RtableAddr[i][j].setAttribute("id","R"+(i-1)+" "+(j-1)); //각 칸마다 id=R0 1이런식
                                }
                            }
                            RtableAddr[i][j].setAttribute("width",40);
                            RtableAddr[i][j].setAttribute("height",30);
                            RtableAddr[i].appendChild(RtableAddr[i][j]);
                        }
                        Rtable.appendChild(RtableAddr[i]);
                    }
                    document.getElementById("setRightTable").appendChild(Rtable);
                //테이블 생성 완료
                </script>
            </div>

        </div>
        <div class="commentBox">

        </div>
    </div>
    
</body>
</html>